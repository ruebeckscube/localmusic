{% load static %}
<!doctype html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <title>{% block title %} Title {% endblock %}</title>

        {# HTMX https://htmx.org/ #}
        <script src="https://unpkg.com/htmx.org@2.0.1"></script>
        {# Alpine plugins (load BEFORE core)#}
        <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/mask@3.x.x/dist/cdn.min.js"></script>
        {# Alpine core https://alpinejs.dev/ #}
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.12.3/dist/cdn.min.js"></script>
        {# Rough.js #}
        <script src="https://unpkg.com/roughjs@latest/bundled/rough.js"></script>
        {# Tailwind https://tailwindcss.com/docs/transition-property #}
        <link rel="stylesheet" href="{% static 'findshows/tailwind.css' %}">

        {# necessary for Alpine to use x-cloak #}
        <style>
         [x-cloak] {
             display: none;
         }
        </style>
    </head>
    <body class="font-mono">
        <div>
            {% include "./nav_bar.html" %}
        </div>
        <div>
            {% block content %}
            {% endblock %}
        </div>
    </body>
    <script>
     // PROOF OF CONCEPT
     // TODO: refactor etc

     function bg_rect(svg, p, roughness) {
         let rough_svg = rough.svg(svg);
         const d = svg.getBoundingClientRect();
         svg.setAttribute('viewBox', '0 0 ' + (d.width + 2*p) + ' ' + (d.height + 2*p));

         svg.appendChild(rough_svg.rectangle(p, p, d.width, d.height, {
             // fill: 'rgba(255,0,200,0.2)',
             // fillWeight: 3,
             // fillStyle: 'solid',
             roughness: roughness,
             strokeWidth: 2,
         }));
     }

     htmx.on("htmx:load", function(evt) { // This fires for initial page load on body, as well as any new element that htmx inserts (individually)
         for (svg of evt.detail.elt.getElementsByClassName('rough-rect')) {
             bg_rect(svg, 10, 5);
         }
     });
    </script>

</html>
