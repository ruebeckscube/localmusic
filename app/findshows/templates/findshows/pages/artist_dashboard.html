{% extends "localmusic/base.html" %}

{% block content %}
<div class="p-3">
    <h1>Artist Dashboard</h1>
    <div class="flex flex-wrap">
        {% if is_local_artist %}
            <div class="bg-highlight-item-light/40 p-3 m-3 min-w-80 flex-grow">
                <h2> Actions </h2>
                <div class="mx-auto w-72">
                    <a class="btn block w-full" href="{% url 'findshows:create_concert' %}">
                        Create new show listing
                    </a>
                </div>
                
                <div class="mx-auto w-72">
                    <form>
                        {% csrf_token %}
                        {% with title_text="Invite Artist" success_text="Invite sent successfully!" form_html="findshows/htmx/temp_artist_form.html" htmx_url="findshows:create_temp_artist" %}
                            {% include "findshows/partials/modal_form.html" %}
                        {% endwith %}
                    </form>
                </div>
            </div>
        {% endif %}

        <div class="bg-highlight-item-light/40 p-3 m-3 min-w-70 flex-grow">
            <h2> Useful links </h2>
            <div class="pl-3">
                <a class="link" target="_blank" href="{% url 'findshows:artist_faq' %}">Artist FAQ</a>
            </div>
        </div>
    </div>

    
    <div class="bg-highlight-item-light/40 p-3 m-3">
        <h2>Artist pages</h2>
        
        <div class="flex flex-wrap align-middle items-center justify-center">
            {% for artist in artists %}
            <div class="flex flex-col items-center m-5 bg-sub-background p-4">
                <div class="text-lg">
                    {{artist.name}}
                </div>
                <div class="w-60 h-60 m-2 flex justify-center items-center">
                    {% if artist.profile_picture %}
                    <img class="max-h-60 max-w-60 object-contain" src="{{ artist.profile_picture.url }}">
                    {% else %}
                    <p class="text-red-700">
                        This artist profile is incomplete! Please edit it so your shows can be listed publically.
                    </p>
                    {% endif %}
                </div>
                <div class="flex justify-center flex-wrap">
                    <a class="btn block" href="{% url 'findshows:view_artist' artist.pk %}">View</a>
                    <a class="btn block" href="{% url 'findshows:edit_artist' artist.pk %}">Edit</a>
                    <form class="mx-auto">
                        {% csrf_token %}
                        {% with title_text="Manage access" success_text="Artist access saved!" form_html="findshows/htmx/artist_access_form.html" htmx_url="findshows:manage_artist_access" htmx_param=artist.pk %}
                            {% include "findshows/partials/modal_form.html"%}
                        {% endwith %}
                    </form>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <div class="bg-highlight-item-light/40 p-3 m-3">
        <h2> My Shows </h2>
        
        <div class="flex flex-col w-full align-middle">
            {% for concert in concerts %}
            <div class="flex max-sm:flex-col m-2">
                <div class="w-full">
                    {% include "findshows/partials/concert_card.html" %}
                </div>
                {% if concert.created_by == user.userprofile %}
                <div class="w-60 flex sm:flex-col justify-center items-center mx-auto my-2">
                    <a class="btn" href="{% url 'findshows:edit_concert' concert.pk %}"> Edit </a>
                    {% include "findshows/htmx/cancel_concert_button.html" %}
                </div>
                {% endif %}
            </div>
            {% empty %}
            <div class="w-fit mx-auto p-2"> You do not have any upcoming shows listed. </div>
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}
